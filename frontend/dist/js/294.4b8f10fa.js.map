{"version":3,"file":"js/294.4b8f10fa.js","mappings":"iNAEEA,EAAAA,EAAAA,IAAuB,UAAnB,kBAAc,G,GAEjBA,EAAAA,EAAAA,IAAgC,SAAzBC,IAAI,SAAQ,SAAK,G,GAJ3BC,IAAA,G,GASGF,EAAAA,EAAAA,IAAoC,SAA7BC,IAAI,YAAW,UAAM,G,GAT/BC,IAAA,G,EAAA,a,GAAAA,IAAA,EAuB6BC,MAAM,e,0CAtBlCC,EAAAA,EAAAA,IAyBO,QAzBDD,MAAM,OAAQE,SAAMC,EAAA,KAAAA,EAAA,IAD3BC,EAAAA,EAAAA,KAAA,IAAAC,IACqCC,EAAAJ,UAAAI,EAAAJ,YAAAG,IAAQ,e,CAC3CE,GACAV,EAAAA,EAAAA,IAIM,OAJAG,OAHRQ,EAAAA,EAAAA,IAAA,iBAAAC,QAG2CH,EAAAI,e,CACxCC,GAAgC,SAChCd,EAAAA,EAAAA,IAAmE,SAA5De,GAAG,QALb,sBAAAT,EAAA,KAAAA,EAAA,GAAAU,GAK8BP,EAAAQ,MAAKD,GAAEE,KAAK,QAASC,OAAIb,EAAA,KAAAA,EAAA,OAAAE,IAAEC,EAAAW,WAAAX,EAAAW,aAAAZ,K,iBAA3BC,EAAAQ,SACdR,EAAAI,aAAU,WAAvBT,EAAAA,EAAAA,IAAiD,QANpDiB,GAAAC,EAAAA,EAAAA,IAM+Bb,EAAAI,YAAU,KANzCU,EAAAA,EAAAA,IAAA,YAQEvB,EAAAA,EAAAA,IAQM,OARAG,OARRQ,EAAAA,EAAAA,IAAA,iBAAAC,QAQ2CH,EAAAe,kB,CACxCC,GAAoC,SACpCzB,EAAAA,EAAAA,IAIwB,SAHvBe,GAAG,WAXP,sBAAAT,EAAA,KAAAA,EAAA,GAAAU,GAYaP,EAAAiB,SAAQV,GACjBE,KAAK,WACJC,OAAIb,EAAA,KAAAA,EAAA,OAAAE,IAAEC,EAAAkB,cAAAlB,EAAAkB,gBAAAnB,K,iBAFEC,EAAAiB,YAGGjB,EAAAe,gBAAa,WAA1BpB,EAAAA,EAAAA,IAAuD,QAf1DwB,GAAAN,EAAAA,EAAAA,IAekCb,EAAAe,eAAa,KAf/CD,EAAAA,EAAAA,IAAA,YAiBEvB,EAAAA,EAAAA,IAKS,UAJRG,MAAM,cACNe,KAAK,SACJW,SAAUpB,EAAAqB,cAAgBrB,EAAAsB,gBAAgB,UAE5C,EAtBFC,GAuBavB,EAAAsB,iBAAc,WAAzB3B,EAAAA,EAAAA,IAEM,MAFN6B,EAA+C,oEAvBjDV,EAAAA,EAAAA,IAAA,W,qDCMO,SAASW,IAEf,MAAMC,EAAmB,kCACnBC,EAAe,8CACfC,EAAgB,wCAEhBC,GAAQC,EAAAA,EAAAA,MAERC,GAASC,EAAAA,EAAAA,OAET,aAAEC,EAAY,aAAEZ,EAAY,YAAEa,IAAgBC,EAAAA,EAAAA,OAGnDC,MAAO5B,EACP6B,aAAcjC,EACdkC,WAAY3B,IACT4B,EAAAA,EAAAA,IACH,QACAC,EAAAA,KAAaC,OAAOC,SAAShB,GAAkBlB,MAAMoB,KAIrDQ,MAAOnB,EACPoB,aAActB,EACduB,WAAYpB,IACTqB,EAAAA,EAAAA,IACH,WACAC,EAAAA,KAAaC,OAAOC,SAAShB,GAAkBiB,IAAI,EAAGhB,IAGjDL,GAAiBsB,EAAAA,EAAAA,KAAS,IAAMV,EAAYE,OAAS,KAG3DS,EAAAA,EAAAA,IAAMvB,GAAiBwB,IAClBA,GACHC,YAAW,KACVb,EAAYE,MAAQ,CAAC,GACnB,IACJ,IAID,MAAMxC,EAAWqC,GAAae,UAC7B,UACOnB,EAAMoB,SAAS,aAAcC,GACnCnB,EAAOoB,KAAK,CAAEC,KAAM,QAErB,CAAE,MAAOC,GAAQ,KAGlB,MAAO,CACN7C,QACAJ,aACAO,YACAM,WACAF,gBACAG,eACAG,eACAC,iBACA1B,WAEF,C,cDjCA,GACC0D,KAAAA,GACC,MAAMC,GAAQC,EAAAA,EAAAA,MACR3B,GAAQC,EAAAA,EAAAA,MAQd,OANIyB,EAAME,MAAMC,SACf7B,EAAMoB,SAAS,aAAc,CAC5Bb,OAAOuB,EAAAA,EAAAA,GAAUJ,EAAME,MAAMC,SAC7BjD,KAAM,YAGD,IAAKgB,IACb,G,UEzCD,MAAMmC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://simple_banker/./src/views/AuthView.vue","webpack://simple_banker/./src/use/login-form.js","webpack://simple_banker/./src/views/AuthView.vue?ce05"],"sourcesContent":["<template>\r\n\t<form class=\"card\" @submit.prevent=\"onSubmit\">\r\n\t\t<h1>Вход в систему</h1>\r\n\t\t<div :class=\"['form-control', { invalid: emailError }]\">\r\n\t\t\t<label for=\"email\">email</label>\r\n\t\t\t<input id=\"email\" v-model=\"email\" type=\"email\" @blur=\"emailBlur\" />\r\n\t\t\t<small v-if=\"emailError\">{{ emailError }}</small>\r\n\t\t</div>\r\n\t\t<div :class=\"['form-control', { invalid: passwordError }]\">\r\n\t\t\t<label for=\"password\">Пароль</label>\r\n\t\t\t<input\r\n\t\t\t\tid=\"password\"\r\n\t\t\t\tv-model=\"password\"\r\n\t\t\t\ttype=\"password\"\r\n\t\t\t\t@blur=\"passwordBlur\" />\r\n\t\t\t<small v-if=\"passwordError\">{{ passwordError }}</small>\r\n\t\t</div>\r\n\t\t<button\r\n\t\t\tclass=\"btn primary\"\r\n\t\t\ttype=\"submit\"\r\n\t\t\t:disabled=\"isSubmitting || isManyAttempts\">\r\n\t\t\tВойти\r\n\t\t</button>\r\n\t\t<div v-if=\"isManyAttempts\" class=\"text-danger\">\r\n\t\t\tВы слишком часто пытаетесь войти в систему. Попробуйте позже\r\n\t\t</div>\r\n\t</form>\r\n</template>\r\n<script>\r\nimport { useRoute } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport { useLoginForm } from '@/use/login-form'\r\nimport errorAuth from '@/utils/errorAuth'\r\n\r\nexport default {\r\n\tsetup() {\r\n\t\tconst route = useRoute()\r\n\t\tconst store = useStore()\r\n\r\n\t\tif (route.query.message) {\r\n\t\t\tstore.dispatch('setMessage', {\r\n\t\t\t\tvalue: errorAuth(route.query.message),\r\n\t\t\t\ttype: 'warning',\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn { ...useLoginForm() }\r\n\t},\r\n}\r\n</script>\r\n<style lang=\"\"></style>\r\n","import { computed, watch } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport * as yup from 'yup'\r\nimport { useField, useForm } from 'vee-validate'\r\nimport { useRouter } from 'vue-router'\r\n\r\nexport function useLoginForm() {\r\n\t// Сообщения\r\n\tconst REQUIRED_MESSAGE = 'Поле обязательно для заполнения'\r\n\tconst PSWD_MESSAGE = 'Пароль должен содержать не менее 8 символов'\r\n\tconst EMAIL_MESSAGE = 'Пожалуйста, введите корректный email'\r\n\t// vuex хранилище\r\n\tconst store = useStore()\r\n\t// роутер\r\n\tconst router = useRouter()\r\n\t// Чисто для формы\r\n\tconst { handleSubmit, isSubmitting, submitCount } = useForm()\r\n\t// email\r\n\tconst {\r\n\t\tvalue: email,\r\n\t\terrorMessage: emailError,\r\n\t\thandleBlur: emailBlur,\r\n\t} = useField(\r\n\t\t'email',\r\n\t\tyup.string().trim().required(REQUIRED_MESSAGE).email(EMAIL_MESSAGE)\r\n\t)\r\n\t// пароль\r\n\tconst {\r\n\t\tvalue: password,\r\n\t\terrorMessage: passwordError,\r\n\t\thandleBlur: passwordBlur,\r\n\t} = useField(\r\n\t\t'password',\r\n\t\tyup.string().trim().required(REQUIRED_MESSAGE).min(8, PSWD_MESSAGE)\r\n\t)\r\n\t// Определяем, сколько раз пытался войти\r\n\tconst isManyAttempts = computed(() => submitCount.value >= 3)\r\n\r\n\t// Заново включаем\r\n\twatch(isManyAttempts, (val) => {\r\n\t\tif (val) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsubmitCount.value = 0\r\n\t\t\t}, 5000)\r\n\t\t}\r\n\t})\r\n\r\n\t// Сабмит формы\r\n\tconst onSubmit = handleSubmit(async (values) => {\r\n\t\ttry {\r\n\t\t\tawait store.dispatch('auth/login', values)\r\n\t\t\trouter.push({ name: 'Home' })\r\n\t\t\t// eslint-disable-next-line no-empty\r\n\t\t} catch (error) {}\r\n\t})\r\n\r\n\treturn {\r\n\t\temail,\r\n\t\temailError,\r\n\t\temailBlur,\r\n\t\tpassword,\r\n\t\tpasswordError,\r\n\t\tpasswordBlur,\r\n\t\tisSubmitting,\r\n\t\tisManyAttempts,\r\n\t\tonSubmit,\r\n\t}\r\n}\r\n","import { render } from \"./AuthView.vue?vue&type=template&id=36fc54ec\"\nimport script from \"./AuthView.vue?vue&type=script&lang=js\"\nexport * from \"./AuthView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","for","key","class","_createElementBlock","onSubmit","_cache","_withModifiers","args","_ctx","_hoisted_1","_normalizeClass","invalid","emailError","_hoisted_2","id","$event","email","type","onBlur","emailBlur","_hoisted_3","_toDisplayString","_createCommentVNode","passwordError","_hoisted_4","password","passwordBlur","_hoisted_5","disabled","isSubmitting","isManyAttempts","_hoisted_6","_hoisted_7","useLoginForm","REQUIRED_MESSAGE","PSWD_MESSAGE","EMAIL_MESSAGE","store","useStore","router","useRouter","handleSubmit","submitCount","useForm","value","errorMessage","handleBlur","useField","yup","trim","required","min","computed","watch","val","setTimeout","async","dispatch","values","push","name","error","setup","route","useRoute","query","message","errorAuth","__exports__","render"],"sourceRoot":""}